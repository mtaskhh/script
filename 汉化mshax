--=============================
-- Roblox é€šç”¨æ±‰åŒ–è„šæœ¬ï¼ˆmshax v4 æ±‰åŒ–ç‰ˆÂ·å¢å¼ºå…¼å®¹ï¼‰
-- ä¼˜åŒ–: å¢å¼ºå…¼å®¹æ€§ï¼Œè§£å†³æ±‰åŒ–å¤±æ•ˆé—®é¢˜
-- ç‰ˆæœ¬: v2.1 å¢å¼ºç‰ˆ
--=============================

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local LP = Players.LocalPlayer
local CoreGui = gethui and gethui() or game:GetService("CoreGui")

-- å…¼å®¹æ€§æ£€æŸ¥
local function safeGetService(serviceName)
    local success, service = pcall(function()
        return game:GetService(serviceName)
    end)
    return success and service or nil
end

--=============================
-- å¢å¼ºç¿»è¯‘è¡¨
--=============================
local TRANSLATIONS = {
    -- è„šæœ¬ä¿¡æ¯
    ["mshax v4"] = "mshax v4",
    ["No Footer"] = "é›·ç”µå‡ºå“",
    ["Disable AFK"] = "é˜²æŒ‚æœºæ£€æµ‹",
    ["Unlock Padlock Distance"] = "è‡ªåŠ¨æŒ‚é”è·ç¦»",
    ["Automation Library Code"] = "å›¾ä¹¦é¦†è‡ªåŠ¨è§£é”",
    ["Method 1"] = "æ¨¡å¼ 1",
    ["Method 2"] = "æ¨¡å¼ 2",
    ["Speed Bypass Method"] = "é€Ÿåº¦ç»•è¿‡æ¨¡å¼",
    ["Ignore List"] = "äº’åŠ¨åˆ—è¡¨",
    ["Bottom"] = "åº•éƒ¨",
    ["Top"] = "é¡¶éƒ¨",
    ["Mouse"] = "é¼ æ ‡",
    ["Center"] = "å‡†å¿ƒ",
    ["Text Size"] = "å­—ä½“å¤§å°",
    ["Arrows Size"] = "ç®­å¤´å¤§å°",
    ["Fill Transparency"] = "å¡«å……é€æ˜åº¦",
    ["Outline Transparency"] = "è½®å»“é€æ˜åº¦",
    ["Text Transparency"] = "å­—ä½“é€æ˜åº¦",
    ["Text Outline Transparency"] = "å­—ä½“è½®å»“é€æ˜åº¦",
    ["Anti Seek-Obstructions"] = "é˜²seekè¿½é€æˆ˜éšœç¢",
    ["Death Farm"] = "è‡ªåŠ¨åˆ·æ­»äº¡å†œåœº",
    ["Generator ESP"] = "å‘ç”µæœºESP",
    ["Ladder ESP"] = "æ¢¯å­ESP",
    ["Fuse ESP"] = "ä¿é™©ä¸ESP",
    ["Anchor ESP"] = "é”šç‚¹ESP",
    ["Water Pump ESP"] = "æ°´æ³µESP",
    ["Notify Anchor Code"] = "é€šçŸ¥é”šç‚¹ä»£ç ",
    ["Remove Figure (FE)"] = "åˆ é™¤Figure(FE)",
    ["Anti Bridge Fall"] = "é˜²æ¡¥æ¢å è½",
    ["Show Seek Path"] = "Seekè¿½è¶³æˆ˜è·¯å¾„æç¤º",
    ["Anticheat Bypass"] = "åä½œå¼Šç»•è¿‡",
    ["Main"] = "ä¸»èœå•",
    ["Player"] = "ç©å®¶",
    ["Exploits"] = "æ¼æ´åˆ©ç”¨",
    ["Visuals"] = "è§†è§‰åŠŸèƒ½",
    ["Floor"] = "åœ°æ¿",
    ["Config"] = "é…ç½®",
    ["Addons"] = "é™„åŠ ç»„ä»¶",
    ["Miscellaneous"] = "æ‚é¡¹",
    ["Movement"] = "è¾…åŠ©",
    ["Camera"] = "è§†è§’",
    ["Fullbright"] = "å…¨äº®",
    ["No Camera Shake"] = "æ— è§†è§’æŠ–åŠ¨",
    ["Third Person"] = "ç¬¬ä¸‰äººç§°",
    ["Spectate Entity"] = "è§‚å¯Ÿå®ä½“",
    ["FOV Slider"] = "FOVå€¼",
    ["FOV"] = "ä½¿ç”¨FOVå€¼",
    ["Noclip"] = "ç©¿å¢™",
    ["No Closet Exit Delay"] = "å¿«é€Ÿå‡ºæŸœå­",
    ["Notifying / ESP"] = "é€šçŸ¥/ESP",
    ["Reach"] = "èŒƒå›´",
    ["Instant Interacts"] = "å³æ—¶äº¤äº’",
    ["Prompt Reach"] = "æ˜¾ç¤ºèŒƒå›´",
    ["Prompt Clip"] = "æç¤ºç©¿é€",
    ["Door Reach"] = "å¼€é—¨èŒƒå›´æå‡",
    ["Anti Lag"] = "é˜²å»¶è¿Ÿ",
    ["No Cutscenes"] = "æ— è§†è¿‡åœºåŠ¨ç”»",
    ["Reset"] = "é‡ç½®",
    ["Play Again"] = "é‡æ–°å¼€å§‹",
    ["Lobby"] = "è¿”å›å¤§å…",
    ["Revive"] = "å¤æ´»ï¼ˆéå…è´¹ï¼‰",
    ["Inf Lockpick / SkeletonKey"] = "æ— é™æ’¬é”å™¨/éª·é«…é’¥åŒ™",
    ["Inf Shears"] = "æ— é™å‰ªåˆ€",
    ["Infinite Items"] = "æ— é™ç‰©å“",
    ["Speed Boost Slider"] = "ç§»é€Ÿä¿®æ”¹",
    ["Speed Boost"] = "å¯ç”¨é€Ÿåº¦",
    ["Fly Speed"] = "é£è¡Œé€Ÿåº¦",
    ["Fly"] = "é£è¡Œ",
    ["Enable Jump"] = "å¯ç”¨è·³è·ƒ",
    ["Infinite Jump"] = "æ— é™è¿è·³",
    ["No Acceleration"] = "æ— åŠ é€Ÿæ»‘åŠ¨",
    ["Entitys"] = "å®ä½“",
    ["Bypass"] = "ç»•è¿‡",
    ["Anti-Dread"] = "é˜²Dread",
    ["Anti-Screech"] = "é˜²Screech",
    ["Anti-A90"] = "é˜²A90",
    ["Anti-Eyes"] = "é˜²Eyes",
    ["Anti-Snare"] = "é˜²åœ°åˆº",
    ["Anti-Dupe"] = "é˜²å‡é—¨",
    ["Anti-Figure-Hearing"] = "é˜²Figureå¬åŠ›æ£€æµ‹",
    ["Anti-Halt"] = "é˜²Halt",
    ["Automation"] = "è‡ªåŠ¨åŒ–",
    ["Auto Interact"] = "è‡ªåŠ¨äº’åŠ¨",
    ["Auto Heartbeat Minigame"] = "è‡ªåŠ¨å¿ƒè·³å°æ¸¸æˆ",
    ["Auto Breaker Box"] = "è‡ªåŠ¨æ–­è·¯å™¨",
    ["Auto Closet"] = "è‡ªåŠ¨èº²è¡£æŸœ",
    ["Speed Bypass"] = "é€Ÿåº¦ç»•è¿‡",
    ["God Mode"] = "æ— æ•Œæ¨¡å¼",
    ["Anti Cheat Manipulation"] = "æ— æ‹‰å›ç©¿å¢™",
    ["Settings"] = "è®¾ç½®",
    ["Enable Tracers"] = "å¯ç”¨è¿½è¸ªçº¿",
    ["Enable Arrows"] = "å¯ç”¨ç®­å¤´",
    ["Enable Show Distances"] = "å¯ç”¨æ˜¾ç¤ºè·ç¦»",
    ["Enable Rainbow"] = "å¯ç”¨å½©è™¹æ•ˆæœ",
    ["ESP Fade Time"] = "ESPç‰¹æ•ˆæŒç»­æ—¶é—´",
    ["ESP Font"] = "ESPå­—ä½“",
    ["Tracer Origin"] = "è¿½è¸ªçº¿èµ·ç‚¹",
    ["Transport"] = "ä¼ é€",
    ["Transparency Slider:"] = "é€æ˜åº¦æ»‘å—:",
    ["Tracer Size"] = "è¿½è¸ªçº¿å¤§å°",
    ["1/5"] = "1/5",
    ["Distance Size Ratio"] = "è·ç¦»å¤§å°æ¯”ä¾‹",
    ["Transparency Closet"] = "è¡£æŸœé€æ˜åº¦",
    ["Transparency Cart"] = "æ¨è½¦é€æ˜åº¦",
    ["Transparent"] = "é€æ˜",
    ["Entites Bypass"] = "é˜²ç‰¹æ®Šç»•è¿‡",
    ["Anti Nanner Banana"] = "é˜²é¦™è•‰",
    ["ESP"] = "ESP",
    ["Timer Lever ESP"] = "è®¡æ—¶å™¨æ æ†ESP",
    ["Entities"] = "å®ä½“åˆ—è¡¨",
    ["Entity Notifys"] = "å®ä½“é€šçŸ¥",
    ["Entities ESP"] = "å®ä½“ESP",
    ["Notify Library Code"] = "é€šçŸ¥å›¾ä¹¦é¦†å¯†ç ",
    ["Modifiers"] = "ä¿®æ”¹å™¨",
    ["Anti Lookman"] = "é˜²Lookman",
    ["Anti Fog"] = "é˜²Fog",
    ["Anti Giggle"] = "é˜²Giggle",
    ["Anti Jamming"] = "é˜²Jamming",
    ["Anti Gloom Egg"] = "é˜²Gloom Egg",
    ["Anti Vacuum"] = "é˜²è™šç©ºé—¨",
    ["Themes"] = "ä¸»é¢˜",
    ["Background color"] = "èƒŒæ™¯é¢œè‰²",
    ["Main color"] = "ä¸»é¢œè‰²",
    ["Accent color"] = "å‰¯è°ƒè‰²",
    ["Outline color"] = "è½®å»“é¢œè‰²",
    ["Font color"] = "å­—ä½“é¢œè‰²",
    [".webm Video Background (Link)"] = ".webmè§†é¢‘èƒŒæ™¯(é“¾æ¥)",
    ["Theme list"] = "ä¸»é¢˜åˆ—è¡¨",
    ["Default"] = "é»˜è®¤",
    ["Set as default"] = "è®¾ä¸ºé»˜è®¤",
    ["Custom theme name"] = "è‡ªå®šä¹‰ä¸»é¢˜åç§°",
    ["Create theme"] = "åˆ›å»ºä¸»é¢˜",
    ["UI"] = "UI",
    ["Fps Unlocker"] = "FPSæ˜¾ç¤º",
    ["Play Sound"] = "æ’­æ”¾å£°éŸ³",
    ["Notify Side"] = "é€šçŸ¥ä½ç½®",
    ["Left"] = "å·¦ä¾§",
    ["Menu bind"] = "èœå•ç»‘å®š",
    ["Show Keybinds"] = "æ˜¾ç¤ºé”®ä½",
    ["Show Custom Cursor"] = "æ˜¾ç¤ºè‡ªå®šä¹‰å…‰æ ‡",
    ["Unload GUI"] = "å¸è½½GUI",
    ["Credits"] = "è‡´è°¢",
    ["Load Config"] = "åŠ è½½é…ç½®",
    ["Which I Use"] = "æˆ‘æ‰€ä½¿ç”¨çš„",
    ["Configuration"] = "é…ç½®",
    ["BBot"] = "BBot",
    ["Facality"] = "Facality",
    ["Jester"] = "Jester",
    ["Mint"] = "Mint",
    ["Tokyo Night"] = "ä¸œäº¬ä¹‹å¤œ",
    ["Ubuntu"] = "Ubuntu",
    ["Quartz"] = "Quartz",
    ["Config name"] = "é…ç½®åç§°",
    ["Create config"] = "åˆ›å»ºé…ç½®",
    ["Config list"] = "é…ç½®åˆ—è¡¨",
    ["Load config"] = "åŠ è½½é…ç½®",
    ["Overwrite config"] = "è¦†ç›–é…ç½®",
    ["Delete config"] = "åˆ é™¤é…ç½®",
    ["Refresh list"] = "åˆ·æ–°åˆ—è¡¨",
    ["Set as autoload"] = "è®¾ä¸ºè‡ªåŠ¨åŠ è½½",
    ["Reset autoload"] = "é‡ç½®è‡ªåŠ¨åŠ è½½",
    ["Current autoload config: none"] = "å½“å‰è‡ªåŠ¨åŠ è½½é…ç½®: æ— ",
    ["Custom themes"] = "è‡ªå®šä¹‰ä¸»é¢˜",
    ["Load theme"] = "åŠ è½½ä¸»é¢˜",
    ["Overwrite theme"] = "è¦†ç›–ä¸»é¢˜",
    ["Delete theme"] = "åˆ é™¤ä¸»é¢˜",
    ["Reset default"] = "é‡ç½®é»˜è®¤",
    ["notzanocoddz - W Guy Made Auto Load Config"] = "è„šæœ¬åŸä½œè€…KardinCat",
    ["KardinCat - Creator"] = "è„šæœ¬ç”±é›·ç”µæ±‰åŒ–",
    ["bocaj11104 - Made The ESP Library Which  I Use"] = " ",
    ["Right"] = "å³ä¾§",
    ["Door"] = "é—¨ESP",
    ["Key"] = "é’¥åŒ™ESP",
    ["Closet ESP"] = "è¡£æŸœESP",
    ["Gate Lever"] = "é“é—¨æ æ†ESP",
    ["Players ESP"] = "ç©å®¶ESP",
    ["Books"] = "å›¾ä¹¦é¦†-ä¹¦ESP",
    ["Breaker"] = "æ–­è·¯å™¨ESP",
    ["Items ESP"] = "ç‰©å“ESP",
    ["Gold ESP"] = "é‡‘å¸ESP",
    ["Close"] = "å…³é—­",
    ["Open"] = "æ‰“å¼€",
    ["Enable"] = "å¯ç”¨",
    ["Disable"] = "ç¦ç”¨",
    ["Toggle"] = "åˆ‡æ¢",
    ["Select"] = "é€‰æ‹©",
    ["Options"] = "é€‰é¡¹",
    ["Advanced"] = "é«˜çº§",
    ["Basic"] = "åŸºç¡€",
    ["Home"] = "ä¸»é¡µ",
    ["Back"] = "è¿”å›",
    ["Next"] = "ä¸‹ä¸€æ­¥",
    ["Previous"] = "ä¸Šä¸€æ­¥",
    ["Save"] = "ä¿å­˜",
    ["Cancel"] = "å–æ¶ˆ",
    ["Apply"] = "åº”ç”¨",
    ["OK"] = "ç¡®å®š",
    ["Yes"] = "æ˜¯",
    ["No"] = "å¦",
}

--=============================
-- å¢å¼ºæ ¸å¿ƒç¿»è¯‘é€»è¾‘
--=============================
local translatedObjects = {}
local isTranslating = false

-- å®‰å…¨å®ä¾‹åˆ›å»º
local function safeInstance(class, parent)
    local success, obj = pcall(function()
        local instance = Instance.new(class)
        if parent then
            instance.Parent = parent
        end
        return instance
    end)
    return success and obj or nil
end

-- å¢å¼ºç¿»è¯‘å‡½æ•°
local function translate(obj, force)
    if not obj or obj:IsA("Folder") or obj:IsA("Configuration") then 
        return 
    end
    
    -- é˜²æ­¢é‡å¤ç¿»è¯‘
    if not force and translatedObjects[obj] then
        return
    end
    
    local success = pcall(function()
        if obj:IsA("TextLabel") or obj:IsA("TextButton") then
            local txt = tostring(obj.Text or "")
            if txt ~= "" and TRANSLATIONS[txt] then
                obj.Text = TRANSLATIONS[txt]
                translatedObjects[obj] = true
            end
        elseif obj:IsA("TextBox") then
            local txt = tostring(obj.Text or "")
            local ph = tostring(obj.PlaceholderText or "")
            
            if txt ~= "" and TRANSLATIONS[txt] then
                obj.Text = TRANSLATIONS[txt]
                translatedObjects[obj] = true
            end
            if ph ~= "" and TRANSLATIONS[ph] then
                obj.PlaceholderText = TRANSLATIONS[ph]
                translatedObjects[obj] = true
            end
        elseif obj:IsA("ImageLabel") or obj:IsA("ImageButton") then
            local nm = tostring(obj.Name or "")
            if nm ~= "" and TRANSLATIONS[nm] and not obj:FindFirstChild("CN_Label") then
                local lbl = safeInstance("TextLabel", obj)
                if lbl then
                    lbl.Name = "CN_Label"
                    lbl.BackgroundTransparency = 1
                    lbl.Size = UDim2.new(1,0,1,0)
                    lbl.Font = Enum.Font.SourceSans
                    lbl.TextSize = math.max(12, math.min(16, obj.AbsoluteSize.Y * 0.4))
                    lbl.TextColor3 = Color3.fromRGB(255,255,255)
                    lbl.TextStrokeTransparency = 0.3
                    lbl.TextStrokeColor3 = Color3.fromRGB(0,0,0)
                    lbl.Text = TRANSLATIONS[nm]
                    lbl.ZIndex = obj.ZIndex + 1
                    lbl.TextXAlignment = Enum.TextXAlignment.Center
                    lbl.TextYAlignment = Enum.TextYAlignment.Center
                    lbl.TextScaled = true
                    translatedObjects[obj] = true
                end
            end
        end
        
        -- å¤„ç†ç‰¹æ®Šå±æ€§
        if obj:IsA("GuiObject") then
            local tooltip = obj:GetAttribute("ToolTip") or obj:GetAttribute("Tooltip")
            if tooltip and type(tooltip) == "string" and TRANSLATIONS[tooltip] then
                obj:SetAttribute("ToolTip", TRANSLATIONS[tooltip])
                obj:SetAttribute("Tooltip", TRANSLATIONS[tooltip])
            end
        end
    end)
    
    if not success then
        -- é™é»˜å¤±è´¥ï¼Œé¿å…é”™è¯¯å¹²æ‰°
    end
end

-- æ‰¹é‡ç¿»è¯‘å‡½æ•°
local function translateAll(root, delay)
    if not root then return end
    
    delay = delay or 0
    
    local function doTranslate()
        isTranslating = true
        local descendants = {}
        
        -- å®‰å…¨è·å–æ‰€æœ‰å­å¯¹è±¡
        local success = pcall(function()
            descendants = root:GetDescendants()
            table.insert(descendants, 1, root)
        end)
        
        if success then
            for i, obj in ipairs(descendants) do
                translate(obj)
                
                -- æ¯å¤„ç†50ä¸ªå¯¹è±¡åyieldä¸€ä¸‹ï¼Œé¿å…å¡é¡¿
                if i % 50 == 0 then
                    RunService.Heartbeat:Wait()
                end
            end
        end
        
        isTranslating = false
    end
    
    if delay > 0 then
        task.wait(delay)
    end
    
    doTranslate()
end

-- å¢å¼ºè¿æ¥å‡½æ•°
local connections = {}
local function attach(root)
    if not root then return end
    
    -- æ¸…ç†æ—§è¿æ¥
    if connections[root] then
        for _, conn in ipairs(connections[root]) do
            if conn and conn.Connected then
                conn:Disconnect()
            end
        end
    end
    connections[root] = {}
    
    -- DescendantAddedè¿æ¥
    local conn1 = root.DescendantAdded:Connect(function(obj)
        if not isTranslating then
            task.wait(0.1) -- çŸ­æš‚å»¶è¿Ÿç¡®ä¿å¯¹è±¡å®Œå…¨åŠ è½½
            translate(obj)
        end
    end)
    table.insert(connections[root], conn1)
    
    -- ChildAddedè¿æ¥ï¼ˆé¢å¤–ä¿é™©ï¼‰
    local conn2 = root.ChildAdded:Connect(function(child)
        if not isTranslating then
            task.wait(0.05)
            translateAll(child)
        end
    end)
    table.insert(connections[root], conn2)
end

--=============================
-- åŠ¨æ€ç›‘å¬ä¸é‡è¯•æœºåˆ¶
--=============================
local retryQueue = {}
local function scheduleRetry(obj, attempts)
    attempts = attempts or 1
    if attempts > 5 then return end
    
    task.wait(0.5 * attempts) -- é€’å¢å»¶è¿Ÿ
    
    if obj and obj.Parent then
        translate(obj, true)
    else
        table.insert(retryQueue, {obj = obj, attempts = attempts + 1})
    end
end

-- å¤„ç†é‡è¯•é˜Ÿåˆ—
spawn(function()
    while true do
        task.wait(1)
        
        local newQueue = {}
        for _, data in ipairs(retryQueue) do
            if data.obj and data.obj.Parent then
                translate(data.obj, true)
            elseif data.attempts < 5 then
                data.attempts = data.attempts + 1
                table.insert(newQueue, data)
            end
        end
        retryQueue = newQueue
    end
end)

--=============================
-- å®æ—¶ç›‘å¬æ–°GUIåˆ›å»º
--=============================
local function monitorNewGuis()
    -- ç›‘å¬PlayerGui
    if LP and LP:WaitForChild("PlayerGui", 5) then
        LP.PlayerGui.ChildAdded:Connect(function(gui)
            task.wait(0.2) -- ç­‰å¾…GUIå®Œå…¨åŠ è½½
            translateAll(gui)
            attach(gui)
        end)
    end
    
    -- ç›‘å¬CoreGui
    CoreGui.ChildAdded:Connect(function(gui)
        task.wait(0.2)
        translateAll(gui)
        attach(gui)
    end)
    
    -- ç‰¹æ®Šå¤„ç†ï¼šç›‘å¬å¸¸è§çš„GUIå®¹å™¨
    local containers = {
        "ScreenGui", "BillboardGui", "SurfaceGui", 
        "Frame", "ScrollingFrame", "CanvasGroup"
    }
    
    for _, container in ipairs(containers) do
        local function handleContainer(parent)
            for _, obj in ipairs(parent:GetChildren()) do
                if obj:IsA(container) then
                    translateAll(obj, 0.1)
                    attach(obj)
                end
            end
        end
        
        if LP and LP:FindFirstChild("PlayerGui") then
            handleContainer(LP.PlayerGui)
        end
        handleContainer(CoreGui)
    end
end

--=============================
-- å¢å¼ºåŠ¨æ€æ·»åŠ ç¿»è¯‘æ¥å£
--=============================
local DEBUG = true -- é»˜è®¤å¼€å¯è°ƒè¯•

local function log(msg, level)
    level = level or "INFO"
    if DEBUG then
        print("[mshax v4 ç¿»è¯‘å™¨][" .. level .. "] " .. msg)
    end
end

local function addTranslation(english, chinese)
    if type(english) == "string" and type(chinese) == "string" and english ~= "" then
        TRANSLATIONS[english] = chinese
        log("æ·»åŠ ç¿»è¯‘: " .. english .. " -> " .. chinese)
        
        -- ç«‹å³åº”ç”¨åˆ°ç°æœ‰å¯¹è±¡
        task.spawn(function()
            if LP and LP:FindFirstChild("PlayerGui") then
                translateAll(LP.PlayerGui, 0.1)
            end
            translateAll(CoreGui, 0.1)
        end)
        
        return true
    end
    log("æ·»åŠ ç¿»è¯‘å¤±è´¥: å‚æ•°æ— æ•ˆ", "ERROR")
    return false
end

local function addTranslations(tbl)
    if type(tbl) ~= "table" then
        log("æ‰¹é‡æ·»åŠ ç¿»è¯‘å¤±è´¥: å‚æ•°å¿…é¡»æ˜¯è¡¨æ ¼", "ERROR")
        return false
    end
    
    local count = 0
    for en, cn in pairs(tbl) do
        if addTranslation(en, cn) then
            count = count + 1
        end
    end
    
    log("æ‰¹é‡æ·»åŠ ç¿»è¯‘å®Œæˆ: æˆåŠŸæ·»åŠ  " .. count .. " é¡¹")
    return true
end

-- å…¨å±€æ¥å£
getgenv().AddTranslation = addTranslation
getgenv().AddTranslations = addTranslations

-- è°ƒè¯•æ¥å£
getgenv().SetTranslatorDebug = function(enabled)
    DEBUG = enabled
    log("è°ƒè¯•æ¨¡å¼" .. (enabled and "å¼€å¯" or "å…³é—­"))
end

getgenv().ForceRetranslate = function()
    log("å¼ºåˆ¶é‡æ–°ç¿»è¯‘æ‰€æœ‰ç•Œé¢...")
    translatedObjects = {}
    if LP and LP:FindFirstChild("PlayerGui") then
        translateAll(LP.PlayerGui)
    end
    translateAll(CoreGui)
    log("å¼ºåˆ¶é‡æ–°ç¿»è¯‘å®Œæˆ")
end

getgenv().GetTranslationStats = function()
    return {
        totalTranslations = #TRANSLATIONS,
        translatedObjects = #translatedObjects,
        isTranslating = isTranslating,
        retryQueueSize = #retryQueue
    }
end

--=============================
-- å¢å¼ºåˆå§‹åŒ–
--=============================
log("å¼€å§‹åˆå§‹åŒ–æ±‰åŒ–ç³»ç»Ÿ...")

-- å»¶è¿Ÿåˆå§‹åŒ–ï¼Œç¡®ä¿æ‰€æœ‰æœåŠ¡åŠ è½½å®Œæˆ
task.spawn(function()
    task.wait(1) -- ç­‰å¾…1ç§’ç¡®ä¿æ¸¸æˆå®Œå…¨åŠ è½½
    
    -- åˆå§‹åŒ–ç°æœ‰GUI
    if LP and LP:WaitForChild("PlayerGui", 10) then
        log("ç¿»è¯‘PlayerGui...")
        translateAll(LP.PlayerGui)
        attach(LP.PlayerGui)
    else
        log("PlayerGuiåŠ è½½å¤±è´¥", "WARN")
    end
    
    log("ç¿»è¯‘CoreGui...")
    translateAll(CoreGui)
    attach(CoreGui)
    
    -- å¼€å§‹ç›‘å¬æ–°GUI
    monitorNewGuis()
    
    log("æ±‰åŒ–ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")
end)

-- å®šæœŸå¼ºåˆ¶æ£€æŸ¥ï¼ˆæ¯30ç§’ï¼‰
spawn(function()
    while true do
        task.wait(30)
        if not isTranslating then
            log("æ‰§è¡Œå®šæœŸæ£€æŸ¥...")
            if LP and LP:FindFirstChild("PlayerGui") then
                translateAll(LP.PlayerGui)
            end
            translateAll(CoreGui)
        end
    end
end)

print("âœ… mshax v4 æ±‰åŒ–ç‰ˆ (å¢å¼ºç‰ˆ v2.1) å·²åŠ è½½ - é›·ç”µå‡ºå“æ±‰åŒ–")
print("ğŸ”§ è°ƒè¯•å‘½ä»¤: getgenv().SetTranslatorDebug(true/false)")
print("ğŸ”„ å¼ºåˆ¶é‡è¯‘: getgenv().ForceRetranslate()")
print("ğŸ“Š æŸ¥çœ‹çŠ¶æ€: getgenv().GetTranslationStats()")

-- å»¶è¿ŸåŠ è½½åŸè„šæœ¬ï¼Œç¡®ä¿æ±‰åŒ–ç³»ç»Ÿå…ˆåˆå§‹åŒ–
task.wait(2)
loadstring(game:HttpGet("https://raw.githubusercontent.com/TheHunterSolo1/Scripts/main/ProhaxV4"))()
